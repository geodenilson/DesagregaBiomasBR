# DesagregaBiomasBR

## üìã Descri√ß√£o

Plugin para QGIS que oferece um **assistente guiado** para sele√ß√£o e desagrega√ß√£o de dados ambientais brasileiros por regi√£o ou recorte espacial. O plugin facilita o acesso e processamento de dados oficiais dos principais programas de monitoramento ambiental do Brasil.

## üéØ Funcionalidades Principais

### üìä **Temas Suportados**

| Tema               | Descri√ß√£o                                              | Fonte              |
|--------------------|--------------------------------------------------------|--------------------|
| **PRODES**         | Mapeamento do desmatamento anual                       | INPE/TerraBrasilis |
| **DETER**          | Alertas de desmatamento em tempo real                  | INPE/TerraBrasilis |
| **TERRACLASS**     | Qualifica√ß√£o do uso da terra em √°reas desflorestadas   | INPE/EMBRAPA       |
| **√ÅREA QUEIMADA**  | Dados mensais de queimadas (produto AQ1Km)             | INPE/LASA-UFRJ     |

### üåø **Biomas Dispon√≠veis**

- **PRODES**: Amaz√¥nia, Amaz√¥nia Legal, Cerrado, Caatinga, Pantanal, Pampa, Mata Atl√¢ntica
- **DETER**: Cerrado, Amaz√¥nia Legal  
- **TERRACLASS**: Amaz√¥nia, Cerrado
- **√ÅREA QUEIMADA**: Amaz√¥nia, Amaz√¥nia Legal, Cerrado, Caatinga, Pantanal, Pampa, Mata Atl√¢ntica

### ‚úÇÔ∏è **Op√ß√µes de Corte Espacial**

1. **Sem limite**: Baixa o bioma completo
2. **Layer do QGIS**: Usa layer j√° carregada no projeto (com filtros opcionais por campo/elemento)
3. **Desenho na tela**: Desenha ret√¢ngulo diretamente no canvas do QGIS
4. **Limites IBGE**: Usa shapefile oficial para corte por estados/munic√≠pios

### üìÅ **Formatos de Sa√≠da**

- **Shapefile** (.shp) - Formato padr√£o
- **GeoPackage** (.gpkg) - Formato moderno

### üó∫Ô∏è **Sistema de Coordenadas**

- **SIRGAS 2000 (EPSG:4674)** - Sistema oficial brasileiro

## üîß Instala√ß√£o

### Requisitos
- QGIS 3.x
- Conex√£o com internet (para download dos dados)

### Instala√ß√£o Manual
1. Baixe ou clone este reposit√≥rio
2. Copie a pasta `DesagregaBiomasBR` para o diret√≥rio de plugins do QGIS:
   - **Windows**: `C:\Users\[usu√°rio]\AppData\Roaming\QGIS\QGIS3\profiles\default\python\plugins\`
   - **Linux**: `~/.local/share/QGIS/QGIS3/profiles/default/python/plugins/`
   - **macOS**: `~/Library/Application Support/QGIS/QGIS3/profiles/default/python/plugins/`
3. Abra o QGIS e ative o plugin em `Plugins > Gerenciar e Instalar Plugins`

### Scripts de Instala√ß√£o
- **Windows**: Execute `install.bat` como Administrador
- **Linux/macOS**: Execute `./install.sh`

## üöÄ Como Usar

### Interface de Assistente Guiado (3 Etapas)

#### **Etapa 1: Sele√ß√£o do Tema**
1. Escolha o tema desejado (PRODES, DETER, TERRACLASS ou √ÅREA QUEIMADA)
2. Selecione o bioma/regi√£o
3. Configure o limite de corte (opcional)

#### **Etapa 2: Configura√ß√µes Espec√≠ficas**

**PRODES:**
- Tipo: Incremental (per√≠odo espec√≠fico) ou Acumulado (desde in√≠cio at√© ano final)
- Per√≠odo: Selecione anos inicial e final

**DETER:**
- Per√≠odo: Anos inicial e final
- Classes: Selecione classes de alertas (DESMATAMENTO_CR, DEGRADA√á√ÉO, etc.)

**TERRACLASS:**
- Ano: Selecione ano de refer√™ncia
- Estado: Obrigat√≥rio
- Munic√≠pio: Opcional (para download municipal)

**√ÅREA QUEIMADA:**
- Tipo: Anual (dados unidos) ou Mensal (arquivos originais)
- Per√≠odo: Ano completo ou m√™s espec√≠fico

#### **Etapa 3: Processamento Final**
1. Configure pasta de destino
2. Escolha formato de sa√≠da
3. Op√ß√µes: Adicionar ao mapa e gerar metadados
4. Inicie o processamento

### üîç **Recursos Avan√ßados**

#### **Sistema de Metadados Completos**
- Informa√ß√µes de origem dos dados
- Metodologia de cada tema
- Configura√ß√µes de processamento
- URLs dos servi√ßos utilizados
- Estat√≠sticas do arquivo final

#### **Corte Autom√°tico por Bioma (√ÅREA QUEIMADA)**
- Dados de queimada cobrem todo o Brasil
- Plugin aplica corte autom√°tico pelo bioma selecionado
- Possibilidade de corte adicional configurado pelo usu√°rio

#### **Sistema de Abort**
- Possibilita interromper downloads longos
- Limpeza autom√°tica de arquivos tempor√°rios

#### **Interface Responsiva**
- Ajuste autom√°tico de tamanho baseado nas op√ß√µes selecionadas
- Notas din√¢micas com resumo das configura√ß√µes
- Sistema de valida√ß√£o em tempo real

## üìà **Configura√ß√µes Espec√≠ficas por Tema**

### **PRODES - Dados de Desmatamento**

**Tipos de Dados:**
- **Incremental**: Desmatamento em per√≠odo espec√≠fico (ex: 2020-2023)
- **Acumulado**: Desmatamento desde o ano base at√© ano final (ex: 2000-2023)

**Anos Base por Bioma:**
- Cerrado, Pantanal, Pampa, Mata Atl√¢ntica, Caatinga: 2000
- Amaz√¥nia, Amaz√¥nia Legal: 2007

**Metodologia:**
- Imagens Landsat ou similares
- √Åreas mapeadas ‚â• 6,25 hectares
- Considera supress√£o de vegeta√ß√£o nativa independente do uso futuro

### **DETER - Alertas de Desmatamento**

**Per√≠odo de Dados:**
- **Cerrado**: Maio/2018 at√© presente
- **Amaz√¥nia Legal**: Agosto/2016 at√© presente

**Classes de Alertas:**
- **Cerrado**: DESMATAMENTO_CR
- **Amaz√¥nia Legal**: CICATRIZ_DE_QUEIMADA, CORTE_SELETIVO, CS_DESORDENADO, CS_GEOMETRICO, DEGRADACAO, DESMATAMENTO_CR, DESMATAMENTO_VEG, MINERACAO

### **TERRACLASS - Uso da Terra**

**Objetivo:**
- Qualificar desflorestamento da Amaz√¥nia Legal e Cerrado
- Mapear uso e cobertura das terras desflorestadas

**Anos Dispon√≠veis:**
- **Amaz√¥nia**: 2008, 2010, 2012, 2014, 2018, 2020, 2022
- **Cerrado**: 2018, 2020, 2022

**Classes Identificadas:**
- Vegeta√ß√£o natural (prim√°ria e secund√°ria)
- Cultura agr√≠cola (perene, semiperene, tempor√°ria)
- Pastagem, silvicultura, minera√ß√£o
- √Årea urbanizada, outros usos, corpos d'√°gua

### **√ÅREA QUEIMADA - Produto AQ1Km**

**Caracter√≠sticas:**
- **Resolu√ß√£o**: 1 km (baixa resolu√ß√£o espacial)
- **Cobertura**: Di√°ria com abordagem sin√≥tica
- **Metodologia**: Algoritmos com bandas t√©rmicas (4 ¬µm) MODIS
- **Per√≠odo**: Setembro/2002 at√© m√™s anterior ao atual

**Tipos de Processamento:**
- **Anual**: Une todos os meses do ano em arquivo √∫nico
- **Mensal**: Mant√©m arquivos mensais originais

**Limita√ß√µes:**
- N√£o recomendado para an√°lises locais (resolu√ß√£o 1 km)
- Ideal para an√°lises regionais/nacionais

## üìÇ **Estrutura de Arquivos**

```
DesagregaBiomasBR/
‚îú‚îÄ‚îÄ __init__.py              # Inicializa√ß√£o do plugin
‚îú‚îÄ‚îÄ plugin_main.py           # Configura√ß√£o principal
‚îú‚îÄ‚îÄ dialog.py                # Interface e l√≥gica principal
‚îú‚îÄ‚îÄ metadata.txt             # Metadados do plugin QGIS
‚îú‚îÄ‚îÄ README.md                # Este arquivo
‚îú‚îÄ‚îÄ resources.py             # Recursos compilados
‚îú‚îÄ‚îÄ resources.qrc           # Defini√ß√£o de recursos
‚îú‚îÄ‚îÄ estilo_terraclass.qml   # Simbologia TERRACLASS
‚îú‚îÄ‚îÄ install.bat             # Script instala√ß√£o Windows
‚îú‚îÄ‚îÄ install.sh              # Script instala√ß√£o Linux/macOS
‚îú‚îÄ‚îÄ icones/                 # √çcones da interface
‚îÇ   ‚îú‚îÄ‚îÄ deter.png
‚îÇ   ‚îú‚îÄ‚îÄ layers.png
‚îÇ   ‚îú‚îÄ‚îÄ mapa.png
‚îÇ   ‚îú‚îÄ‚îÄ prodes.png
‚îÇ   ‚îî‚îÄ‚îÄ queimadas.png
‚îî‚îÄ‚îÄ shapefile/              # Dados IBGE para cortes
    ‚îú‚îÄ‚îÄ BC250, 2023.cpg
    ‚îú‚îÄ‚îÄ BC250, 2023.dbf
    ‚îú‚îÄ‚îÄ BC250, 2023.prj
    ‚îú‚îÄ‚îÄ BC250, 2023.shp
    ‚îú‚îÄ‚îÄ BC250, 2023.shx
    ‚îî‚îÄ‚îÄ BC250, 2023.shp.xml
```

## üîó **URLs dos Servi√ßos**

### **PRODES - WFS TerraBrasilis**
- Amaz√¥nia: `https://terrabrasilis.dpi.inpe.br/geoserver/prodes-amazon-nb/*/ows`
- Cerrado: `https://terrabrasilis.dpi.inpe.br/geoserver/prodes-cerrado-nb/*/ows`
- Outros biomas: URLs espec√≠ficas por bioma

### **DETER - WFS TerraBrasilis**  
- Cerrado: `https://terrabrasilis.dpi.inpe.br/geoserver/deter-cerrado-nb/deter_cerrado/ows`
- Amaz√¥nia Legal: `https://terrabrasilis.dpi.inpe.br/geoserver/deter-amz/deter_amz/ows`

### **TERRACLASS - Download Direto**
- Base: `https://www.terraclass.gov.br/helpers/terraclass_data4download_2024/`
- Estrutura: `V/{tipo}/{bioma}.{ano}.{localidade}.{geocodigo}.V.zip`

### **√ÅREA QUEIMADA - Download ZIP**
- Base: `https://dataserver-coids.inpe.br/queimadas/queimadas/area_queimada/AQ1km/shp/`
- Formato: `{YYYY_MM_01}_aq1km_{v6|V6}.zip`

## ‚öôÔ∏è **Configura√ß√µes T√©cnicas**

### **Processamento de Dados**
- Download autom√°tico via WFS/HTTP
- Corte espacial usando algoritmos nativos do QGIS
- Corre√ß√£o autom√°tica de geometrias inv√°lidas
- Reproje√ß√£o autom√°tica para SIRGAS 2000
- Merge de m√∫ltiplas camadas quando necess√°rio

### **Otimiza√ß√µes**
- Download paginado para grandes volumes de dados
- Sistema de cache para m√∫ltiplas tentativas
- Verifica√ß√£o de abort durante processamentos longos
- Limpeza autom√°tica de arquivos tempor√°rios

### **Logs e Debug**
- Sistema de logs persistentes usando QgsMessageLog
- Mensagens de debug detalhadas para resolu√ß√£o de problemas
- Valida√ß√£o de geometrias e CRS
- Relat√≥rios de estat√≠sticas de processamento

## üêõ **Solu√ß√£o de Problemas**

### **Problemas Comuns**

**Erro de conectividade:**
- Verifique conex√£o com internet
- URLs dos servi√ßos podem estar temporariamente indispon√≠veis

**Geometrias inv√°lidas:**
- Plugin aplica corre√ß√£o autom√°tica usando `native:fixgeometries`
- Se persistir, verifique dados de entrada

**CRS incompat√≠veis:**
- Plugin reprojeta automaticamente para EPSG:4674
- Dados de sa√≠da sempre em SIRGAS 2000

**Download interrompido:**
- Use bot√£o "Abortar Download" para parar seguramente
- Arquivos tempor√°rios s√£o limpos automaticamente

### **Logs de Debug**
Os logs detalhados ficam dispon√≠veis em:
- QGIS > Exibir > Pain√©is > Log de Mensagens > DesagregaBiomasBR

## üìö **Refer√™ncias**

### **Fontes de Dados**
- **PRODES/DETER**: Instituto Nacional de Pesquisas Espaciais (INPE) - TerraBrasilis
- **TERRACLASS**: INPE/EMBRAPA
- **√ÅREA QUEIMADA**: INPE/LASA-UFRJ
- **Limites IBGE**: Instituto Brasileiro de Geografia e Estat√≠stica

### **Metodologias**
- **AQ1Km**: LIBONATI, R. et al. Remote Sensing, v. 7, p. 15782‚Äì15803, 2015
- **PRODES**: Metodologia INPE para detec√ß√£o de desmatamento
- **TERRACLASS**: An√°lise de s√©ries temporais de imagens 20-10m

## üìÑ **Licen√ßa**

Este plugin √© desenvolvido para facilitar o acesso aos dados p√∫blicos de monitoramento ambiental brasileiro.

## ü§ù **Contribui√ß√µes**

Contribui√ß√µes s√£o bem-vindas! Para melhorias ou corre√ß√µes:

1. Fa√ßa fork do projeto
2. Crie uma branch para sua feature
3. Commit suas mudan√ßas
4. Push para a branch
5. Abra um Pull Request

## üìß **Suporte**

Para d√∫vidas ou problemas:
- Abra uma issue neste reposit√≥rio
- Consulte os logs de debug do QGIS
- Verifique a documenta√ß√£o das fontes de dados originais

## üôè **Agradecimentos**

Agradecimentos especiais √†s institui√ß√µes que disponibilizam dados p√∫blicos e financiaram essa pesquisa:
- **INPE** - Instituto Nacional de Pesquisas Espaciais
- **EMBRAPA** - Empresa Brasileira de Pesquisa Agropecu√°ria  
- **IBGE** - Instituto Brasileiro de Geografia e Estat√≠stica
- **LASA-UFRJ** - Laborat√≥rio de Aplica√ß√µes de Sat√©lites Ambientais
- **FAO** - Organiza√ß√£o das Na√ß√µes Unidas para Alimenta√ß√£o e Agricultura

E √† comunidade QGIS pelo excelente framework de desenvolvimento de plugins! üó∫Ô∏è

---

**Desenvolvido para facilitar o acesso aos dados de monitoramento ambiental do Brasil** üáßüá∑ 